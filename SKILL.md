---
name: k-grant-apply
description: >
  한국연구재단(NRF) 연구개발과제 연구계획서를 HWPX 형식으로 자동 생성하는 스킬.
  사용자가 연구 내용을 입력하면 NRF 표준 양식에 맞게 계획서를 작성하여 HWPX 파일로 저장한다.
  MANDATORY TRIGGERS: k-grant-apply, NRF 계획서, 연구재단 계획서, 연구계획서 작성,
  NRF 연구계획서, 국가연구개발 계획서, 한국연구재단 신청서, grant proposal, NRF proposal,
  연구개발계획서, 연구재단 신청서.
---

# NRF 연구개발과제 연구계획서 작성

## Overview

이 스킬은 한국연구재단(NRF) 표준 양식에 맞는 연구계획서를 HWPX 파일로 자동 생성함.
사용자의 연구 내용을 수집하여 `assets/application.hwpx` 템플릿에 채워 넣음.

---

## 글쓰기 원칙 (필수 준수)

**모든 문장은 "임", "음", "함"으로 끝나야 함.**

| 금지 | 권장 |
|------|------|
| ~입니다 | ~임 |
| ~합니다 | ~함 |
| ~됩니다 | ~됨 |
| ~있습니다 | ~있음 |
| ~한다 | ~함 |
| ~된다 | ~됨 |

---

## 섹션별 작성 깊이 기준 ← 핵심

### 3) 연구개발과제의 내용 ← 가장 상세히 작성

연구계획서에서 **3) 연구개발과제의 내용이 가장 상세하고 핵심적인 섹션임.**
1) 필요성과 2) 목표는 3)의 내용을 요약·압축하여 작성함.

**3) 연구내용 작성 기준:**
- 각 연차별, 기관별(주관/공동/기관외)로 구분하여 4~6개 연구 항목 기술
- 각 항목은 다음 요소를 포함:
  1. **수행 실험/분석 명칭** (구체적 기술 명칭 사용)
  2. **사용 기기·시약·소프트웨어** (예: 10x Genomics Chromium, Seurat v5, ArchR)
  3. **분석 파이프라인 상세** (QC → 처리 → 분석 → 검증 순서)
  4. **기대 데이터/산출물** (예: scRNA-seq 20,000 cells/sample × 30례)
  5. **연계 분석** (다른 기관과의 협력 내용 포함)

**오믹스/생물정보학 파이프라인 기술 예시:**
```
scRNA-seq 분석: 10x Genomics Chromium Next GEM 3' v3.1 키트 사용,
NovaSeq 6000(50,000 reads/cell), FastQC → STARsolo 정렬 →
Seurat v5(R)/Scanpy(Python) QC(미토콘드리아 비율 <25%, UMI 200-8000),
Harmony 기반 배치 보정, UMAP 시각화, FindMarkers DEA(Wilcoxon),
GSEA(clusterProfiler) 경로 분석 수행함.
```

**1) 필요성 작성 기준:**
- **2단계 레벨만 사용:** `○` 주요 항목 + `   -` 세부 항목 (□ 소제목 레벨 사용 금지)
- ○ 항목마다 3~6개 `   -` 세부 bullet 포함
- 국내외 연구 동향, 기존 연구의 한계, 본 연구의 차별성을 각각 구분하여 기술
- **연구팀 선행연구** 반드시 포함 (논문/특허 있으면 인용)
- **해외 협력기관의 강점** 별도 소항목으로 상세 기술 (국제협력 평가항목 해당 시)
- 분량 기준: 5~10페이지 (예시 파일 수준)

**2) 목표 작성 기준:**
- 최종 목표: 3)에서 달성할 핵심 성과를 2~3줄로 압축
- 연차별 목표: 해당 연차의 3)에서 가장 핵심적인 1~2줄 요약
- 반드시 실제 연차 번호 기입: 1차년도, 2차년도, 3차년도 (N차년도 금지)
- 단계 번호도 실제 입력: 1단계, 2단계 (N단계 금지)

---

## 서식 기준

- **장 제목**: 17포인트 고딕계열 (템플릿 서식 유지)
- **절 제목**: 15포인트 명조계열 (템플릿 서식 유지)
- **본문**: 11포인트, 가로쓰기
- **1페이지** = 11포인트 기준 약 37~40줄 (A4)

---

## Workflow

### Step 1: RFP (사업공고문) 확인 ← 최우선

**가장 먼저 RFP 파일 유무를 확인함.**

RFP 파일을 받으면 **반드시 전체를 읽고** 다음 항목을 추출:

| 항목 | 추출 내용 |
|------|-----------|
| 사업명 | 공식 사업명 |
| 사업목적 | 핵심 목적 및 기대 성과 |
| 지원 분야/주제 | 연구분야, 주요 키워드 |
| 지원 자격 | 연구책임자/기관 요건 |
| **연구기간/단계** | 총 기간, **연차별 기간(몇 개월)**, 단계 수(1단계/2단계) |
| **연구비** | 총액 및 **연차별 지원금** |
| **분량 기준** | 섹션별 페이지 제한 |
| **필수 제출 서류** | 추가 서류 목록 |
| **평가 기준** | 평가항목 및 배점 |
| 특기사항 | 주의사항, 우대 조건 |

#### RFP에서 연차·단계 파악 (JSON _meta 생성)

RFP를 읽고 다음을 결정함:
- **total_years**: 총 연차 수 (예: 3년 과제 → 3)
- **stage**: 단계 수 (1단계 과제 → 1, 2단계 과제 → 2)
- **year_months**: 각 연차별 연구 개월 수 (예: 1차년도 6개월, 2차년도 12개월)

**_meta JSON 예시:**
```json
{
  "_meta": {
    "total_years": 3,
    "stage": 1,
    "year1_months": 6,
    "year2_months": 12,
    "year3_months": 12
  }
}
```

RFP에 명시되지 않은 경우 사용자에게 직접 질문:
"연구기간이 몇 년이고, 몇 단계로 구성되어 있나요? 1차년도는 몇 개월인가요?"

#### RFP 기반 작성 전략 수립

평가 기준에 맞춰 섹션별 강조점을 결정함:
- "창의성(30점)" → 3) 연구내용에서 혁신적 방법론 강조
- "국제협력(35점)" → 1) 필요성에서 해외 협력기관 강점 소항목 추가
- "실현가능성(25점)" → 선행연구 성과와 보유 인프라 상세 기술

---

### Step 2: 참조문헌 및 선행연구 자료 수집

연구계획서 작성 전에 **참조문헌과 선행연구 자료를 확보함.**

**확인 순서:**
1. **연구팀 논문 자료 요청:**
   "연구팀(주관/공동기관)의 관련 논문이나 선행연구 자료가 있으시면 파일 경로를 알려주세요.
   PDF, DOCX, TXT 등 어떤 형식이든 됩니다."

2. **제공된 자료 읽기:** 파일을 읽고 핵심 선행연구 성과를 정리함.
   - 연구팀 고유 기술/데이터/툴
   - 발표된 논문의 주요 결과
   - 보유 코호트/인프라 현황

3. **부족한 배경지식 웹 검색:**
   - 해당 분야 최신 연구 동향 검색 (WebSearch 활용)
   - 해외 협력기관 전문성 확인
   - 관련 기술의 시장 규모/현황 데이터 수집

4. **참조문헌 목록 구성:**
   - 1) 필요성 섹션에 각주 형식으로 인용할 문헌 목록 준비
   - 형식: `저자 et al. 저널명 연도` (예: `Velmeshev et al. Science 2019`)

---

### Step 3: 추가 서류 및 분량 기준 확인

RFP 기반 필수 제출 서류 안내 및 분량 제한 고지.

**분량 기준 (RFP 미명시 시 기본값):**
- 1) 필요성: 5~10페이지
- 2) 목표: 3~5페이지 (연차별 목표 포함)
- 3) 연구내용: 8~15페이지 ← **가장 큰 비중**
- 4) 수행일정: 1~2페이지 (Gantt 표)
- 3.1 추진전략: 3~5페이지
- 3.2 추진체계: 2~3페이지
- 4.1 활용방안: 2~3페이지
- 4.2 기대효과: 2~3페이지

---

### Step 4: 양식 확인

NRF 표준 양식 파일(.hwpx) 여부 확인. 없으면 `assets/application.hwpx` 사용.

---

### Step 5: 기본 정보 수집

1. 연구과제명 (국문/영문)
2. 연구책임자 (이름, 소속, 직위)
3. 공동/기관외 연구자 정보
4. 연구기간 및 연차별 연구비
5. 출력 파일 경로 (기본값: `~/Desktop/NRF_연구계획서.hwpx`)

---

### Step 6: 3) 연구내용 먼저 작성 ← 핵심

**3)을 먼저 작성하고, 이를 바탕으로 1)과 2)를 작성함.**

각 섹션 시작 시 "RFP에서 이 섹션과 관련된 평가항목: [항목명(배점)]"을 표시함.

**모호한 내용 처리 원칙 (중요):**
작성 중 다음 상황이 발생하면 **즉시 작성을 멈추고 사용자에게 확인함:**
- 연구 대상 수(샘플 수, 환자 수)가 불명확할 때
- 특정 기술/장비명이 정확하지 않을 때
- 협력기관의 구체적 역할이 불명확할 때
- 연차별 목표가 현실적인지 판단이 어려울 때
- 선행연구 성과(논문 제목, 저널, 연도)를 추정만 할 수 있을 때

**확인 방법:**
> "현재 [내용] 부분에서 [구체적 질문]이 필요합니다. 어떻게 작성할까요?"

추정이 불가피한 경우: `[확인 필요: 내용]` 표시 후 계속 작성하고, 완료 후 사용자 검토 요청.

---

#### 섹션 3: 연구개발 내용 (연차별·기관별) ← 최우선 작성

**작성 형식:**
```
year{N}_main: [
  "연구주제명 + 핵심 방법론: 세부 기기/소프트웨어, 분석 파이프라인, 샘플 수/데이터 규모, 기대 산출물",
  ...
]
```

**항목 수**: 주관기관 4~6개, 공동기관 2~4개

**오믹스/생물정보학 파이프라인 기술 필수 포함 요소:**
- 시퀀싱 플랫폼 및 키트 (예: 10x Genomics Chromium Next GEM 3' v3.1)
- 시퀀싱 깊이 (예: NovaSeq 6000, 50,000 reads/cell)
- QC 기준 (예: 미토콘드리아 비율 <25%, nGene 200-8000)
- 분석 소프트웨어/패키지 버전 (예: Seurat v5, Scanpy 1.9, ArchR v1.0)
- 데이터 통합 방법 (예: Harmony, scVI, CCA)
- 통계 분석 방법 (예: DESeq2, MAST, Wilcoxon rank-sum)
- 경로 분석 (예: GSEA, KEGG, Reactome via clusterProfiler)
- 검증 방법 (예: qRT-PCR, immunofluorescence, CRISPR knockdown)

**예시 (ASD 오가노이드 연구):**
```
"ASD 환자(20례) 및 정상 대조군(10례) iPSC 유래 피질 오가노이드
single-nucleus RNA-seq(snRNA-seq) 수행: 10x Genomics Chromium Next GEM 3' v3.1,
NovaSeq 6000(depth 50,000 reads/cell), 각 샘플당 최소 5,000개 핵 프로파일링.
CellRanger v8 정렬(GRCh38), Seurat v5 QC(미토콘드리아 <20%, nGene 300-8000),
Harmony 배치 보정, UMAP 클러스터링, MAST 기반 세포 유형별 DEA(FDR<0.05) 수행.
SFARI score 1-2 ASD 위험 유전자(n=856) 발현 패턴을 세포 유형별 비교 분석함."
```

---

#### 섹션 1: 연구개발과제의 필요성 (3) 요약 기반)

**작성 형식 — ○(명사형) / 　-(최소 3~4개) 두 레벨만 사용 (□ 소제목 금지):**
```
"○ 질환/분야 현황 및 사회경제적 부담",
"   - 유병률 수치 및 추세 (문헌 인용).",
"   - 사회경제적 비용 정량 근거.",
"   - 국내 현황 구체 수치.",
"   - 현행 치료의 한계.",
"",
"○ 기존 연구 방법론의 구조적 한계",
"   - 한계점 1.",
"   - 한계점 2.",
"   - 한계점 3.",
"",
"○ 핵심 기술·플랫폼의 패러다임 전환적 가능성",
"   - 기술 설명 1.",
"   - 기술 설명 2.",
"   - 연구팀 보유 자산.",
"   - 기술의 차별성.",
"",
"○ 국제협력 파트너의 상보적 강점 및 시너지",
"   - 파트너 강점 1.",
"   - 파트너 강점 2.",
"   - 한국 팀 자산과의 결합 효과.",
"   - 단독 연구 대비 우수성.",
"",
"○ 연구팀 선행연구 성과 및 연구의 독창성",
"   - PI 선행 논문/데이터셋.",
"   - 공동연구팀 선행 논문/플랫폼.",
"   - 위탁연구팀 선행 논문/모델.",
"   - 본 연구의 통합적 차별성.",
```

**필수 포함 주제 (각각 ○ 명사형 항목으로):**
1. 질환/분야의 현황 및 사회적 문제 (유병률, 경제적 부담, 치료 한계)
2. 기존 연구 방법론의 한계 (왜 새로운 접근이 필요한가)
3. 핵심 기술(플랫폼)의 현황 및 가능성
4. 연구팀 선행연구 성과 (논문/특허/코호트/플랫폼 등)
5. 협력기관(국내외) 강점 — **국제협력 평가항목 있을 때 반드시 상세 기술**
6. 본 연구의 차별성 및 국가적 필요성

**선행연구 인용 형식:** `(저자 et al. 저널 연도)`

---

#### 섹션 2-1: 최종 목표 (3) 압축 요약)

3)에서 달성할 가장 핵심적인 성과를 2~3개 목표로 압축함.
정량적 성과 지표 (논문 편수, 특허 건수, 코호트 규모 등) 반드시 포함.

---

#### 섹션 2-2: 연차(단계)별 목표

**반드시 실제 연차 번호 사용:** 1차년도, 2차년도, 3차년도 (N차년도 사용 금지)
**반드시 실제 단계 번호 사용:** 1단계, 2단계 (N단계 사용 금지)

RFP에서 파악한 total_years와 stage를 _meta에 입력해야 스크립트가 자동으로 변환함.

각 연차 목표는 해당 연차 3)의 핵심을 1~2문장으로 요약함.

---

#### 섹션 3-1: 추진전략·방법

연구 방법론 요약, IP 전략, 데이터 관리, 국제 협력 체계를 기술함.

---

#### 섹션 3-2: 추진체계

주관/공동/기관외 기관의 역할 분담을 체계적으로 기술함.
"추진체계 도식은 한컴오피스에서 직접 삽입 필요" 라고 안내함.

---

#### 섹션 4-1: 활용방안 / 섹션 4-2: 기대효과

과학적·경제적·사회적 기대효과를 구분하여 기술함.

---

#### 섹션 4) 수행일정 및 주요 결과물

**3)의 연차별 연구내용을 기반으로 수행일정 표를 작성함.**

JSON의 `schedule` 키에 다음 형식으로 입력:
```json
{
  "schedule": {
    "year1": [
      {"task": "추진내용 (구체적 연구 활동명)", "result": "결과물 (구체적 산출물)"},
      ...
    ],
    "year2": [...],
    "year3": [...]
  }
}
```

**작성 기준:**
- 추진내용: 3)의 각 연구항목에서 핵심 활동을 추출 (간결하게 30자 이내)
- 결과물: 해당 활동의 구체적 산출물 (데이터, 논문, 특허, 플랫폼 등)
- 연차별 4~8개 항목 권장

---

### Step 7: 연구개념도·모식도 생성 (나노바나나프로)

**필요한 그림 유형:**
- 1) 필요성 섹션: 연구 배경 현황 그래프/다이어그램 (2~3개)
- 2) 목표 섹션: 연구 목표 요약 다이어그램
- 3) 연구내용: 연차별 연구 흐름도, 분석 파이프라인 모식도 (2~4개)
- 3-2) 추진체계: 연구팀 체계도

**나노바나나프로 사용 방법 (gemini-cli 필요):**
```bash
# gemini-cli 설치 확인
which gemini || npm install -g @google/gemini-cli

# 그림 생성 예시
gemini "다음 연구 파이프라인을 ASCII 다이어그램으로 그려줘: [내용]"
```

나노바나나프로가 설치되어 있으면:
```bash
# 연구 흐름도 생성
nanobanana-pro --prompt "ASD iPSC → 오가노이드 → scRNA-seq 파이프라인 모식도" --output figure1.svg
```

**주의:** 생성된 그림은 한컴오피스에서 해당 섹션에 직접 삽입해야 함.
그림 생성이 불가한 경우 사용자에게 삽입 위치와 그림 내용을 안내함.

---

### Step 8: 내용 검토 및 RFP 체크리스트

| 점검 항목 | 확인 |
|-----------|------|
| 3) 연구내용이 가장 상세한가 | ✓/✗ |
| 1) 필요성에 ○/   - 두 레벨 구조가 있는가 (□ 소제목 없음) | ✓/✗ |
| 연차 번호가 실제 숫자로 기입되었는가 (N차년도 없음) | ✓/✗ |
| 단계 번호가 실제 숫자로 기입되었는가 (N단계 없음) | ✓/✗ |
| 사업목적에 부합하는 연구 주제인가 | ✓/✗ |
| 평가 기준 항목이 모두 커버되는가 | ✓/✗ |
| 오믹스 파이프라인 상세가 포함되어 있는가 | ✓/✗ |
| 참조문헌이 인용되었는가 | ✓/✗ |
| 수행일정(schedule)이 작성되었는가 | ✓/✗ |
| 각 섹션 분량이 기준 내인가 | ✓/✗ |

---

### Step 9: JSON 데이터 생성

수집된 내용을 다음 JSON 형식으로 정리:

```json
{
  "_meta": {
    "total_years": 3,
    "stage": 1,
    "year1_months": 6,
    "year2_months": 12,
    "year3_months": 12
  },
  "necessity": [
    "○ 첫 번째 주요 항목 (수치, 문헌 근거 포함).",
    "   - 세부 내용 1",
    "   - 세부 내용 2",
    "",
    "○ 두 번째 주요 항목.",
    "   - 세부 내용"
  ],
  "final_goal": [
    "○ 최종 목표 1 (정량 지표 포함)",
    "   - 세부 성과물",
    "○ 최종 목표 2"
  ],
  "yearly_goals": {
    "year1_main": "1차년도 주관과제 핵심 목표 요약 (1~2문장)",
    "year1_joint": "1차년도 공동과제 목표 (없으면 빈 문자열)",
    "year1_contracted": "",
    "year2_main": "2차년도 주관과제 목표",
    "year2_joint": "",
    "year2_contracted": "",
    "year3_main": "3차년도 주관과제 목표",
    "year3_joint": "",
    "year3_contracted": ""
  },
  "yearly_contents": {
    "year1_main": [
      "연구활동명 + 구체적 기기/소프트웨어 + 분석파이프라인 + 샘플규모 + 기대산출물",
      "..."
    ],
    "year1_joint": ["..."],
    "year1_contracted": [],
    "year2_main": ["..."],
    "year2_joint": ["..."],
    "year2_contracted": [],
    "year3_main": ["..."],
    "year3_joint": ["..."],
    "year3_contracted": []
  },
  "schedule": {
    "year1": [
      {"task": "추진내용 (30자 이내)", "result": "결과물"},
      {"task": "...", "result": "..."}
    ],
    "year2": [...],
    "year3": [...]
  },
  "strategy": [
    "○ 핵심 추진전략",
    "   - 세부 방법"
  ],
  "system": [
    "○ 주관연구개발기관(기관명, 책임자): 역할 요약.",
    "   - 세부 역할"
  ],
  "utilization": ["○ 활용방안"],
  "effects": ["○ 과학적 기대효과", "○ 경제적 기대효과", "○ 사회적 기대효과"],
  "commercialization": {
    "market_size": [], "demand": [], "competition": [], "ip": [],
    "standardization": [], "biz_strategy": [], "investment": [], "production": []
  }
}
```

**content_lines 형식 규칙 (2단계 레벨만 사용):**
- `"○ 명사형 소제목"` → 주요 항목 (1단계). **반드시 명사형으로 끝남** (예: "~의 현황", "~의 한계", "~의 전략")
- `"   - 세부 문장."` → 세부 항목 (2단계). 각 ○ 항목 아래 **최소 3~4개 이상** 필수. 문장은 "임/음/함/됨"으로 끝남.
- `""` → 빈 줄 (○ 항목 간 시각적 구분)
- **□ 소제목 레벨은 사용하지 않음**

**들여쓰기 균일성 (indentation uniformity):**
- ○ 항목과 - 항목의 들여쓰기가 섹션 전체에서 **균일**해야 함
- ○ 항목: 들여쓰기 없이 행 시작 (첫 번째 문자 = "○")
- - 항목: ○ 항목보다 4칸 들여쓰기 (첫 번째 문자 = "-")
- ○/- 기호가 heading 텍스트보다 앞에 나오면 안 됨 → HWPX 생성 후 한컴오피스에서 단락 서식의 들여쓰기/내어쓰기 수동 조정 필요
- JSON 문자열에서는 `"○ 소제목"` / `"   - 세부항목"` 형식을 엄격히 유지함

**○ 명사형 예시:**
- ✗ "○ ASD는 사회적 의사소통 장애로 유병률이 증가하고 있음." (문장형)
- ✓ "○ ASD 전 세계적 유병률 현황 및 사회경제적 부담" (명사형)
- 모든 문장은 "임", "음", "함"으로 끝날 것

---

### Step 10: HWPX 파일 생성

```bash
# 1. lxml 설치 확인
pip3 show lxml || pip3 install lxml

# 2. JSON 저장
cat > /tmp/nrf_data.json << 'EOF'
{JSON 내용}
EOF

# 3. HWPX 생성
SKILL_DIR="$HOME/.claude/skills/k-grant-apply"
python3 "$SKILL_DIR/scripts/write_hwpx.py" \
  --template "$SKILL_DIR/assets/application.hwpx" \
  --output "{출력경로}" \
  --data-json /tmp/nrf_data.json
```

---

### Step 11: 생성 확인 및 안내

생성 완료 후 안내:
1. 생성된 파일 경로
2. **수동 작업 필요 항목:**
   - "작성요령(제출 시 삭제 요망)" 박스 삭제
   - 수행일정 표 월별 진행 표시 (▶/■) 직접 작성
   - 추진체계 도식(그림) 삽입
   - 각주(참조문헌) 삽입
   - MoU/확약서 등 별도 서류 준비

---

## 파일 구조

```
k-grant-apply/
├── SKILL.md
├── assets/
│   └── application.hwpx       ← NRF 표준 양식 (2·3차년도 Gantt 9행 pre-expanded)
│   └── application.hwpx.bak   ← 원본 백업 (expand_template.py 실행 전)
└── scripts/
    ├── write_hwpx.py           ← HWPX 생성 스크립트 (텍스트 채움 전용)
    └── expand_template.py      ← 템플릿 Gantt 행 사전 확장 스크립트
```

## 기술 상세

HWPX는 ZIP+XML 구조. `Contents/section0.xml`의 `<hp:p>` 요소 수정.
- `○     -` placeholder → 내용 단락으로 교체
- `□ N차년도(N단계)` → `_meta.total_years`와 `_meta.stage`로 실제 연차 교체 및 복제
- `- 연구개발 내용 N:` → yearly_contents 항목으로 교체 (필요 시 줄 복제)
- `schedule` 데이터 → 수행일정 Gantt 표 task 행에 추가

섹션 구조 (placeholder 순서):
- 0: 1장 필요성
- 1: 2.1 최종 목표
- 2: 3.1 추진전략
- 3: 3.2 추진체계
- 4: 4.1 활용방안
- 5: 4.2 기대효과
- 6~13: 5장 사업화 (해당 시)

### HWPX 테이블 무결성 (중요 노하우)

수행일정 Gantt 표를 수정할 때 다음 속성을 반드시 동기화해야 함:

| 속성 | 위치 | 중요성 |
|------|------|--------|
| `rowCnt` | `<hp:tbl rowCnt="N">` | **행 수와 반드시 일치** — 불일치 시 파일 손상 |
| `cellAddr.rowAddr` | 각 `<hp:tc>` 안 | 실제 행 인덱스와 일치 필요 |
| `sz.height` | `<hp:tbl><hp:sz>` | 행 추가 시 높이 재계산 필요 |
| `linesegarray` | `<hp:p>` 안 | 텍스트 변경 후 **반드시 제거** (레이아웃 캐시) |

**expand_template.py 역할:**
템플릿의 2·3차년도 Gantt 행을 미리 9개씩 확장해 저장함.
write_hwpx.py는 런타임 행 복제 없이 텍스트만 채움.
템플릿 재확장 시 실행:
```bash
python3 ~/.claude/skills/k-grant-apply/scripts/expand_template.py
```

**수행일정 표 구조:**
- 1차년도 task 행: 26셀 (task 셀 rowSpan=3), 24셀 연속행 존재
- 2·3차년도 task 행: 14셀 1행 구조 (task+Gantt 12셀+result 1행으로 완결)
- task 내용 길이: 30자 이내 권장 (셀 높이 h=1282 기준 약 2~3줄)
